<!-- build time:Wed Mar 01 2023 16:00:33 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="乌弥的小屋" href="https://www.umi.homes/rss.xml"><link rel="alternate" type="application/atom+xml" title="乌弥的小屋" href="https://www.umi.homes/atom.xml"><link rel="alternate" type="application/json" title="乌弥的小屋" href="https://www.umi.homes/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="前端学习,JavaScript"><link rel="canonical" href="https://www.umi.homes/posts/c8f1/"><title>事件初步 - 前端基础 - 前端学习 | Umi's Blog = 乌弥的小屋 = 等待和希望，人类的智慧就包含在这两个词中</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">事件初步</h1><div class="meta"><span class="item" title="创建时间：2022-11-12 16:10:35"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-11-12T16:10:35+08:00">2022-11-12</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>10k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Umi's Blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://cdn.staticaly.com/gh/umitsurumi/image-hosting@master/cover/illust_58389429_20190327_124842_copy.6xkd4h865fw0.webp"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 24 150 28" preserveaspectratio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/front-end/" itemprop="item" rel="index" title="分类于 前端学习"><span itemprop="name">前端学习</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/front-end/front-end-basis/" itemprop="item" rel="index" title="分类于 前端基础"><span itemprop="name">前端基础</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.umi.homes/posts/c8f1/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Umi"><meta itemprop="description" content="等待和希望，人类的智慧就包含在这两个词中, 乌弥的个人博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="乌弥的小屋"></span><div class="body md" itemprop="articleBody"><h2 id="事件基础"><a class="markdownIt-Anchor" href="#事件基础">#</a> 事件基础</h2><h3 id="事件简介"><a class="markdownIt-Anchor" href="#事件简介">#</a> 事件简介</h3><h4 id="常见事件"><a class="markdownIt-Anchor" href="#常见事件">#</a> 常见事件</h4><p><strong>事件</strong>是某事发生的信号，所有 DOM 节点都生成这样的信号。这是一些常见的 DOM 事件：</p><ol><li><p>鼠标事件</p><ul><li><code>click</code> ：鼠标点击一个元素时</li><li><code>contextmenu</code> ：鼠标右键点击一个元素时</li><li><code>mouseover/mouseout</code> ：鼠标指针移入 / 离开一个元素时</li><li><code>mousedown/mouseup</code> ：在元素上按下 / 释放鼠标时</li><li><code>mousemove</code> ：鼠标移动时</li></ul></li><li><p>键盘事件</p><ul><li><code>keydown/keyup</code> ：按下和松开一个按键时</li></ul></li><li><p>表单元素</p><ul><li><code>submit</code> ：用户提交了一个 <code>&lt;form&gt;</code> 时</li><li><code>focus</code> ：用户聚焦于一个元素时</li></ul></li><li><p>Document 事件</p><ul><li><code>DOMContentLoaded</code> ：在 HTML 被加载和处理完成时，DOM 被完全构建完成时</li></ul></li><li><p>CSS 事件</p><ul><li><code>transitioned</code> ：在一个 CSS 动画完成时</li></ul></li></ol><h4 id="事件处理程序"><a class="markdownIt-Anchor" href="#事件处理程序">#</a> 事件处理程序</h4><p>处理程序可以对事件做出响应，在发生对应行为时运行相应的 JavaScript 代码。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- 为 input 分配一个 click 处理程序，在 HTML 设置 on&lt;event > 特性 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Click me<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Click!'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">&lt;!-- 当代码较多时，可以将其设置为函数 --></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function">alertHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alertHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Hello! * 3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">&lt;!-- 通过 DOM 属性 on&lt;event > 的方式和直接设置 HTML 特性是相同的 --></span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>elem<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>click<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token keyword">let</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"elem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  elem<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>这两种方法中，一种是通过 HTML 特性初始化的，另一种是通过脚本初始化的，除此之外它们是相同。<br>因为只有一个 <code>onclick</code> 属性，设置 <code>onclick = null</code> 即可移除设置的处理程序。<br>在处理程序中 <code>this</code> 指向这个对应元素。</p><p><code>addEventListener</code> 方法可以为一个事件分配多个处理程序。<br><code>elem.addEventListener(event, handler[, options])</code> ：</p><ul><li><code>event</code> ：事件名</li><li><code>handler</code> ：处理程序</li><li><code>options</code> ：可选关键词<ul><li><code>once</code> ：如果为 <code>true</code> ，那么在触发后自地删除监听器</li><li><code>capture</code> ：事件处理阶段，冒泡或者捕获</li><li><code>passive</code> ：如果为 <code>true</code> ，那么处理程序将不会被调用默认行为</li></ul></li></ul><p><code>elem.removeEventListener(event, handler[, options])</code> 移除添加的监听器</p><div class="note info"><p>移除时需要相同的函数，如果是使用箭头函数而没有将函数存储在变量中，则无法移除它。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 这样并不能移除函数，因为它们是不同的函数对象</span></pre></td></tr><tr><td data-num="3"></td><td><pre>elem<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></div><h4 id="事件对象"><a class="markdownIt-Anchor" href="#事件对象">#</a> 事件对象</h4><p>事件发生的时候，浏览器会创建一个 <code>event</code> 对象，将信息放入其中并传递给处理程序。<br><code>event</code> 对象通常有这些属性：</p><ul><li><code>event.type</code> ：事件类型，如 <code>click</code></li><li><code>event.currentTarget</code> ：处理事件的元素，这里与 <code>this</code> 相同</li><li><code>event.clientX/event.clientY</code> ：指针事件的指针的窗口的相对坐标</li></ul><h3 id="冒泡与捕获"><a class="markdownIt-Anchor" href="#冒泡与捕获">#</a> 冒泡与捕获</h3><h4 id="冒泡"><a class="markdownIt-Anchor" href="#冒泡">#</a> 冒泡</h4><p>冒泡（bubbling）是指，<strong>当一个事件发生在元素上时，它会首先运行在该元素上的处理程序，然后在运行其父元素上的处理程序，然后一直向上直达其他祖先元素</strong>。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- 这里有三层嵌套，它们各自拥有一个处理程序 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">&lt;!-- 先运行 p 上的，然后是 p 外的 div，然后是 div 外的 div，直到最后的 document 对象 --></span></pre></td></tr></table></figure><div onclick='alert("1")' style="width:200px;height:160px;background:orange"><div onclick='alert("2")' style="margin:auto;width:160px;height:120px;background:#ff0;transform:translateY(20px)"><p onclick='alert("3")' style="margin:auto;width:120px;height:80px;background:green;transform:translateY(20px)"></p></div></div><p>点击绿色的区域，将依次看见 3，2，1 三个 <code>alert</code> 。</p><p>事件从内部元素 “冒泡” 到几乎所有父级，这个过程称为 “冒泡”。<br>冒泡事件从目标元素（ <code>event.target</code> ）开始向上，到 <code>&lt;html&gt;</code> 甚至 <code>window</code> ，它们会调用路径上的所有处理程序。<br><code>event.stopPropagation()</code> 方法可以停止冒泡，但是如果一个元素在一个事件上有多个处理程序，即使其中一个停止冒泡，其他处理程序仍会执行。<br>冒泡带来了很多方便，阻止冒泡可能会导致一些意想不到的问题，<strong>除非有显而易见的需要，否则不应该随便停止冒泡</strong>。</p><h4 id="捕获"><a class="markdownIt-Anchor" href="#捕获">#</a> 捕获</h4><p>捕获（capturing）是事件处理的另一个阶段。<br>DOM 事件标准中，事件传播有三个阶段，捕获阶段 - 目标阶段 - 冒泡阶段。<br>捕获阶段最先发生，事件向下走近元素，目标阶段事件到达元素，然后事件开始冒泡。<br>使用 <code>on&lt;event&gt;</code> 和 <code>addEventListener</code> 处理的事件仅在第二第三阶段进行。</p><p>如果要在捕获阶段处理事件，需要将 <code>capture</code> 设置为 <code>true</code> ：</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">capture</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="事件委托"><a class="markdownIt-Anchor" href="#事件委托">#</a> 事件委托</h3><p>冒泡与委托结合，可以实现更灵活的事件处理模式 —— 事件委托。<br>事件委托模式可以用于为相似元素添加相同的处理，通常如下：</p><ol><li>在容器上放置一个处理程序</li><li>在处理程序中，检查源元素 <code>event.target</code></li><li>事件发生在目标元素上，处理事件</li></ol><div class="tab" data-id="eventTab" data-title="优点"><ol><li>简化初始化事件处理程序，节省内存</li><li>添加移除元素时，无需修改处理程序</li><li>方便 DOM 修改</li></ol></div><div class="tab" data-id="eventTab" data-title="缺点"><ol><li>仅适用于可以冒泡的事件</li><li>委托可能增加负载，因为容器级的处理程序会对容器内任意位置的事件都做出反应</li></ol></div><p>一个事件委托的例子如下，事件处理程序并不是在每一个元素上添加的，而是在它们的父元素上：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token selector">#container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token property">width</span><span class="token punctuation">:</span> 340px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token property">height</span><span class="token punctuation">:</span> 340px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token property">align-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token selector">.box</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token property">line-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>red<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>blue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>yellow<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>orange<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>green<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>purple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>pink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>grey<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>darkred<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">let</span> color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    container<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>className <span class="token operator">==</span> <span class="token string">"box"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">let</span> box <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        color <span class="token operator">==</span> <span class="token string">"white"</span> <span class="token operator">?</span> <span class="token punctuation">(</span>color <span class="token operator">=</span> box<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        box<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> color<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="默认行为"><a class="markdownIt-Anchor" href="#默认行为">#</a> 默认行为</h3><p>默认行为是指事件被触发时，浏览器自动执行的行为，例如：</p><ul><li>点击一个 <code>&lt;a&gt;</code> 标签，触发导航到该 URL</li><li>点击表单提交按钮，触发提交到服务器行为</li><li>文本上按下鼠标并移动，选中文本</li></ul><p>大部分情况下它们都很有用，但是少部分的场景可能并不希望浏览器的默认行为。<br>一种方法是 <code>on&lt;event&gt;=&quot;return false</code> ，它会阻止默认事件，如果事件由 <code>on&lt;event&gt;</code> 分配；<br>另一种方法是使用 <code>event</code> 对象，有一个 <code>event.preventDefault()</code> 方法。<br><code>addListener</code> 方法中的 <code>passive: true</code> 选项告诉浏览器该行为不会被阻止。<br>如果默认行为被阻止， <code>event.defaultPrevented</code> 的值会变成 <code>true</code> ，否则为 <code>false</code> 。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token keyword">return</span> <span class="token boolean">false</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript">event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>Click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="ui-事件"><a class="markdownIt-Anchor" href="#ui-事件">#</a> UI 事件</h2><h3 id="鼠标事件"><a class="markdownIt-Anchor" href="#鼠标事件">#</a> 鼠标事件</h3><h4 id="鼠标事件简介"><a class="markdownIt-Anchor" href="#鼠标事件简介">#</a> 鼠标事件简介</h4><ol><li><p>事件类型<br>在元素上点击 / 释放鼠标按钮： <code>mousedown/mouseup</code><br>鼠标指针从元素上移入 / 移出： <code>mouseover/mouseout</code><br>鼠标在元素上移动： <code>mousemove</code><br>鼠标左键点击元素，在 <code>mousedown</code> 和 <code>mouseup</code> 后触发 <code>click</code><br>鼠标右键按下触发上下文菜单： <code>contextmenu</code></p><p>当一个用户操作会触发多个事件时，事件的顺序是固定的：如点击鼠标左键，会遵循 <code>mousedown</code> -&gt; <code>mouseup</code> -&gt; <code>click</code> 的顺序。</p><p><code>event.button</code> 记录了鼠标按键的类型：</p><table><thead><tr><th>鼠标按键类型</th><th><code>event.button</code> 的值</th></tr></thead><tbody><tr><td>左键（主要按键）</td><td>0</td></tr><tr><td>中键（辅助按键）</td><td>1</td></tr><tr><td>右键（次要按键）</td><td>2</td></tr><tr><td>X1（后退按键）</td><td>3</td></tr><tr><td>X2（前进按键）</td><td>4</td></tr></tbody></table></li><li><p>组合按键<br>所有鼠标事件都包含以下组合键的信息：<br><code>shiftKey</code> ：shift 键<br><code>altKey</code> ：alt 键<br><code>ctrlKey</code> ：ctrl 键<br><code>metaKey</code> ：windows 的 win 键和 mac 的 cmd 键</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Alt + Shift + Click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">&lt;!-- 组合点击键，按下 alt+shift 键同时点击才生效 --></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  button<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>altKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>shiftKey<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li><li><p>鼠标坐标<br>所有鼠标事件都提供了两种形式的坐标：<br><code>clientX/clientY</code> ：相较于窗口的坐标<br><code>pageX/pageY</code> ：相较于文档的坐标<br><input onmousemove='this.value=event.clientX+":"+event.clientY'></p></li><li><p>防止鼠标选中<br>阻止浏览器的 <code>mousedown</code> 操作，可以防止双击时鼠标选中文本或者按下鼠标选中文本。</p><div onmousedown="return!1" style="font-style:italic">这是一段鼠标按下或者双击不会选中的文字</div><p>同样的，阻止 <code>copy</code> 事件也可以防止右键复制或者快捷键复制。</p><div oncopy='return alert("禁止复制"),!1' style="font-style:italic">这是一段禁止复制的文字</div></li></ol><h4 id="移动鼠标"><a class="markdownIt-Anchor" href="#移动鼠标">#</a> 移动鼠标</h4><p>当鼠标移动到某个元素上时， <code>mouseover</code> 事件发生，鼠标离开这个元素时， <code>mouseout</code> 事件发生<br>这两个事件具备 <code>relatedTarget</code> 属性：</p><ul><li>在 <code>mouseover</code> 中，是鼠标来自的那个元素 <code>relatedTarget</code> -&gt; <code>target</code></li><li>在 <code>mouseout</code> 中，是鼠标移动到的，当下的元素 <code>target</code> -&gt; <code>relatedTarget</code></li></ul><p>鼠标移动时会触发 <code>mouseover</code> 事件，但是并不是每一个像素变化都会触发。<br>浏览器会检测鼠标的位置，如果发生了变化就会触发事件，当访问者非常快速地移动鼠标时，某些 DOM 元素可能被跳过。<br><code>mouseout</code> 事件在鼠标指针从元素移动到其后代时也触发（浏览器默认鼠标指针随时位于嵌套最多的那个单个元素上），而在后代中的 <code>mouseover</code> 事件还会冒泡，所以如果父元素有 <code>mouseover</code> 处理程序也会被触发。<br>在这种情况下，如果不检查 <code>event.target</code> ，似乎认为鼠标离开了父元素，但是鼠标此时仍然在父元素范围内，它只是更深入地指向了父元素中的子元素。</p><p>有些时候为了阻止这种情况可以使用 <code>mouseenter</code> 和 <code>mouseleave</code> ：</p><ul><li>它们元素内部和后代之间的转换不会发生影响</li><li>这两个事件不会冒泡</li></ul><p>鼠标进入一个元素，触发 <code>mouseenter</code> ，鼠标离开该元素，触发 <code>mouseleave</code> 。</p><h4 id="鼠标拖拽"><a class="markdownIt-Anchor" href="#鼠标拖拽">#</a> 鼠标拖拽</h4><p>一个基础的拖拽算法如下：</p><ol><li>在 <code>mousedown</code> 上根据需要准备好要移动的元素</li><li>在 <code>mouseover</code> 上通过更改 <code>position: absolute</code> 情况下的 <code>left/top</code> 来移动它</li><li>在 <code>mouseup</code> 上执行与完成拖放相关行为</li></ol><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 禁用浏览器默认拖拽处理</span></pre></td></tr><tr><td data-num="2"></td><td><pre>ball<span class="token punctuation">.</span><span class="token function-variable function">ondragstart</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>ball<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// 准备移动，设置为绝对定位，层级 z-index 最高保证在顶部</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">"absolute"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zIndex <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token comment">// 将其从当前父元素移动到 body 中，保证定位是相对 body 的</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>ball<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token comment">// 现在球的中心在 (pageX,pageY) 坐标上</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">function</span> <span class="token function">moveAt</span><span class="token punctuation">(</span><span class="token parameter">pageX<span class="token punctuation">,</span> pageY</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> pageX <span class="token operator">-</span> ball<span class="token punctuation">.</span>offsetWidth <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> pageY <span class="token operator">-</span> ball<span class="token punctuation">.</span>offsetHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token comment">// 将绝对定位的球移到指针下</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token function">moveAt</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span> event<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token keyword">function</span> <span class="token function">onMouseMove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">moveAt</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span> event<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token comment">// 在 mousemove 事件上移动球</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> onMouseMove<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token comment">// 放下球并移除不需要的处理程序</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  ball<span class="token punctuation">.</span><span class="token function-variable function">onmouseup</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> onMouseMove<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    ball<span class="token punctuation">.</span>onmouseup <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>优化：</p><ol><li>保持元素相对于鼠标指针的初始偏移：</li></ol><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 访问者按下鼠标时，记住鼠标指针到球左上角的距离</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//onmousedown</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> shiftX <span class="token operator">=</span> event<span class="token punctuation">.</span>clientX <span class="token operator">-</span> ball<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> shiftY <span class="token operator">=</span> event<span class="token punctuation">.</span>clientY <span class="token operator">-</span> ball<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 移动时，将偏移量也纳入考虑</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//onmousemove</span></pre></td></tr><tr><td data-num="7"></td><td><pre>ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> pageX <span class="token operator">-</span> shiftX <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>ball<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> pageY <span class="token operator">-</span> shiftY <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="2"><li>可放置的目标<br>在可拖到元素中，被拖到的元素始终在其他元素之上，因此在较低的元素上设置的处理程序都不会起作用。<br><code>document.elementFromPoint(clientX, clientY)</code> 可以返回在给定窗口相对处嵌套最深的元素，如果同坐标上有多个则返回最上面的一个元素。<br>利用这个方法可以改进拖拽：</li></ol><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 正在飞过的潜在 droppable 元素</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//currentDroppable 用于存储当前放置目标</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> currentDroppable <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 改进 onMouseMove</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">function</span> <span class="token function">onMouseMove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token function">moveAt</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span> event<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token comment">// 先隐藏拖动的元素，否则获得的是拖到的元素（在最上面）</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  ball<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">let</span> elemBelow <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">elementFromPoint</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  ball<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token comment">// 边界条件，如果 clientX/clientY 在窗口，拖到对象拖出窗口时</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>elemBelow<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token comment">// 潜在可放置对象使用 “droppable” 标记</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">let</span> droppableBelow <span class="token operator">=</span> elemBelow<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">".droppable"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentDroppable <span class="token operator">!=</span> droppableBelow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token comment">// 正在飞入或飞出</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentDroppable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token comment">// 飞出 droppable 元素的相关处理函数</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token function">leaveDroppable</span><span class="token punctuation">(</span>currentDroppable<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    currentDroppable <span class="token operator">=</span> droppableBelow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentDroppable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token comment">// 飞入 droppable 元素的相关处理函数</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token function">enterDroppable</span><span class="token punctuation">(</span>currentDroppable<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id="指针事件"><a class="markdownIt-Anchor" href="#指针事件">#</a> 指针事件</h4><p>指针事件是鼠标事件的扩展，用于处理包括鼠标、触控等现代输入方法。<br>指针事件具备和鼠标事件完全相同的属性，包括 <code>clientX/Y</code> 和 <code>target</code> 等，还有一些其他属性：</p><ul><li><code>pointerID</code> ：触发当前事件指针的唯一标识符，由浏览器生成的，用于处理多指针的情况</li><li><code>pointerType</code> ：指针设备的类型，字符串。如： <code>mouse</code> 、 <code>pen</code> 或 <code>touch</code></li><li><code>isPrimary</code> ：指针是否为首要指针（如多点触控按下第一根手指时）</li></ul><p>对于多点触控的设备（如平板或手机），每一个触摸都会分配一个 <code>pointerID</code> ，利用 <code>pointerID</code> ，可以追踪到多根正在触碰的手指。第一个触摸相关联的事件总有 <code>isPrimary = true</code> 。</p><p>指针捕获（Pointer capturing）是针对指针事件的一个特性。主要方法是：<br><code>elem.setPointerCapture(pointerID)</code> ：将给定的 <code>pointerID</code> 绑定到 <code>elem</code> 上，在调用后，所有具有相同 <code>pointerID</code> 的指针都将 <code>elem</code> 作为目标，无论 <code>elem</code> 在文档中的实际位置。<br>以下情况会移除绑定：</p><ul><li>当 <code>pointerup</code> 或者 <code>pointercancel</code> 事件出现时，绑定会被自动移除</li><li>当 <code>elem</code> 元素从文档中删除后，绑定被移除</li><li><code>elem.releasePointerCapture(pointerID)</code> 调用后，移除绑定</li></ul><p>在一个元素启用触发后， <code>gotpointercapture</code> 会触发。同样的，当绑定被移除后， <code>lostpointercapture</code> 会触发。</p><h3 id="键盘与滚动"><a class="markdownIt-Anchor" href="#键盘与滚动">#</a> 键盘与滚动</h3><ol><li><p>键盘事件<br>当按键被按下时，会触发 <code>keydown</code> 事件，按键释放时，触发 <code>keyup</code> 事件。<br>事件对象的 <code>key</code> 获取按键字符， <code>code</code> 获取按键代码。<br>一般来说： - 字符键的代码为 <code>Key&lt;letter&gt;</code> - 数字键的代码为 <code>Digit&lt;number&gt;</code> - 特殊按键代码为特殊按键名字 <code>Enter</code> 、 <code>Tab</code> 、 <code>ShiftRight</code> 等</p><div class="note info"><p>大多数键盘事件的默认行为可以被阻止，但是 OS 相关的特殊按键除外（如 alt+F4 关闭浏览器窗口），它们无法通过 JavaScript 进行阻止。</p></div></li><li><p>滚动事件<br><code>scroll</code> 事件允许对页面或元素滚动做出反应。<br>通过滚动，可以根据用户在文档中位置显示 / 隐藏其他控件或信息</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"scroll"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  document<span class="token punctuation">.</span><span class="token function">getElmentById</span><span class="token punctuation">(</span><span class="token string">"showScroll"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    window<span class="token punctuation">.</span>pageYOffset <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><h3 id="表单与控件"><a class="markdownIt-Anchor" href="#表单与控件">#</a> 表单与控件</h3><h4 id="表单属性和方法"><a class="markdownIt-Anchor" href="#表单属性和方法">#</a> 表单属性和方法</h4><p>表单是特殊集合 <code>document.forms</code> 的成员</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myForm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>one<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>two<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">let</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>myForm<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">//  获取 name 为 myForm 的表单，也可以使用如下方式：</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token comment">//  let form = document.forms[0]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">//  获取文档中的第一个表单</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">let</span> elem <span class="token operator">=</span> form<span class="token punctuation">.</span>elements<span class="token punctuation">.</span>one<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token comment">// 表单中的元素都可以通过命名的集合 form.elements 来访问到</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token comment">// 如果有多个名字相同的元素，那么 form.elements [name] 获得的是一个集合</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token comment">// 表单中的元素，反过来也可以通过 element.form 找到它所处的表单</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token function">alert</span><span class="token punctuation">(</span>form <span class="token operator">===</span> elem<span class="token punctuation">.</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h4 id="表单控件"><a class="markdownIt-Anchor" href="#表单控件">#</a> 表单控件</h4><ol><li><p>input 和 textarea<br><code>input.value</code> 或者 <code>input.checked</code> 可以访问 <code>input</code> 控件中的 <code>value</code> 值<br><code>textarea.value</code> 访问 <code>textarea</code> 中的 <code>value</code> 值</p></li><li><p>select 和 option<br><code>select</code> 有以下三个重要属性：</p><ul><li><code>select.options</code> ： <code>option</code> 的子元素的集合</li><li><code>select.value</code> ：当前所选的 <code>option</code> 的值</li><li><code>select.selectedIndex</code> ：当前所选的 <code>option</code> 的编号</li></ul><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>select<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>apple<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Apple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>banana<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Banana<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pear<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Pear<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 以下三种操作所作的都是同一件事</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  select<span class="token punctuation">.</span>option<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  select<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"banana"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  select<span class="token punctuation">.</span>selectedIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li></ol><h4 id="focusblur"><a class="markdownIt-Anchor" href="#focusblur">#</a> focus/blur</h4><p>当元素聚焦时，触发 <code>focus</code> 事件，当元素失去焦点时，触发 <code>blur</code> 事件。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token selector">.invalid</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">border-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token selector">#error</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>请输入邮箱：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>  input<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>input<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      input<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">".invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      error<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"请输入一个邮箱！"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>  input<span class="token punctuation">.</span><span class="token function-variable function">onfocus</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">".invalid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">".invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      error<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p><code>elem.focus()</code> 和 <code>elem.blur()</code> 方法可以设置和移除元素身上的焦点。<br><code>focus</code> 和 <code>blur</code> 不会冒泡，但是可以改在捕获阶段触发，或者使用 <code>focusin/focusout</code> 替代。<br>大多数元素支持聚焦，但是可以通过 <code>tabindex</code> 使元素变为可聚焦的。<br><code>document.activeElement</code> 获取当前所聚焦的元素。</p><h4 id="表单更新事件"><a class="markdownIt-Anchor" href="#表单更新事件">#</a> 表单更新事件</h4><ol><li>change<br>当元素更改完成，发生 <code>change</code> 事件</li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- 当输入完成后，切换到其他地方时，触发 change 事件 --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">&lt;!--select 或者 checkbox/radio 会在选项更新后触发 change 事件 --></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token special-attr"><span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>options<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>option1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>option2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ol start="2"><li><p>input<br>每次用户对输入值进行修改后，触发 <code>input</code> 事件。<br>只要值改变了， <code>input</code> 事件就会发生，包括语言输入，鼠标粘贴等。</p></li><li><p>cut，copy 和 paste<br>发生在剪切 / 拷贝或者粘贴一个值时。<br>使用 <code>event.preventDefault()</code> 可以阻止复制 / 粘贴行为。</p></li></ol><h4 id="表单提交"><a class="markdownIt-Anchor" href="#表单提交">#</a> 表单提交</h4><p>点击 <code>&lt;input type=&quot;submit&quot;&gt;</code> 或在 <code>input</code> 字段中按下回车键，都可以触发 <code>submit</code> 事件。<br>如果要手动提交表单可以调用 <code>form.submit()</code> 方法。</p><div class="tags"><a href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag"><i class="ic i-tag"></i> 前端</a> <a href="/tags/JavaScript/" rel="tag"><i class="ic i-tag"></i> JavaScript</a> <a href="/tags/BOM/" rel="tag"><i class="ic i-tag"></i> BOM</a> <a href="/tags/DOM/" rel="tag"><i class="ic i-tag"></i> DOM</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-03-02 00:00:14" itemprop="dateModified" datetime="2023-03-02T00:00:14+08:00">2023-03-02</time> </span><span id="posts/c8f1/" class="item leancloud_visitors" data-flag-title="事件初步" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span>此文章已被阅读次数: </span><span id="twikoo_visitors">正在加载...</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Umi <i class="ic i-at"><em>@</em></i>乌弥的小屋</li><li class="link"><strong>本文链接：</strong> <a href="https://www.umi.homes/posts/c8f1/" title="事件初步">https://www.umi.homes/posts/c8f1/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/posts/c9b1/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;cdn.staticaly.com&#x2F;gh&#x2F;umitsurumi&#x2F;image-hosting@master&#x2F;cover&#x2F;illust_58389429_20190327_124838_copy.6zn73l0zys00.webp" title="浏览器环境，Document"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 前端基础</span><h3>浏览器环境，Document</h3></a></div><div class="item right"><a href="/posts/cb89/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;cdn.staticaly.com&#x2F;gh&#x2F;umitsurumi&#x2F;image-hosting@master&#x2F;cover&#x2F;js-data-structure.2fnl9ticubr4.webp" title="概述"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 数据结构</span><h3>概述</h3></a></div></div><div class="wrap"><div id="tcomments"></div></div><script src="https://cdn.staticfile.org/twikoo/1.6.9/twikoo.all.min.js"></script><script data-pjax>setTimeout(function(){twikoo.init({envId:"https://twikoo.umi.homes",el:"#tcomments"})},1e3)</script></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">事件基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">事件简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.1.1.</span> <span class="toc-text">常见事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">事件处理程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.3.</span> <span class="toc-text">事件对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%92%E6%B3%A1%E4%B8%8E%E6%8D%95%E8%8E%B7"><span class="toc-number">1.2.</span> <span class="toc-text">冒泡与捕获</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%92%E6%B3%A1"><span class="toc-number">1.2.1.</span> <span class="toc-text">冒泡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7"><span class="toc-number">1.2.2.</span> <span class="toc-text">捕获</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98"><span class="toc-number">1.3.</span> <span class="toc-text">事件委托</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA"><span class="toc-number">1.4.</span> <span class="toc-text">默认行为</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ui-%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">UI 事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">鼠标事件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text">鼠标事件简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E9%BC%A0%E6%A0%87"><span class="toc-number">2.1.2.</span> <span class="toc-text">移动鼠标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E6%8B%96%E6%8B%BD"><span class="toc-number">2.1.3.</span> <span class="toc-text">鼠标拖拽</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.1.4.</span> <span class="toc-text">指针事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%AE%E7%9B%98%E4%B8%8E%E6%BB%9A%E5%8A%A8"><span class="toc-number">2.2.</span> <span class="toc-text">键盘与滚动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E4%B8%8E%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">表单与控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.1.</span> <span class="toc-text">表单属性和方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.3.2.</span> <span class="toc-text">表单控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#focusblur"><span class="toc-number">2.3.3.</span> <span class="toc-text">focus&#x2F;blur</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%9B%B4%E6%96%B0%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.3.4.</span> <span class="toc-text">表单更新事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4"><span class="toc-number">2.3.5.</span> <span class="toc-text">表单提交</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/posts/5731/" rel="bookmark" title="HTML基础知识">HTML基础知识</a></li><li><a href="/posts/62621/" rel="bookmark" title="CSS基础知识">CSS基础知识</a></li><li><a href="/posts/62941/" rel="bookmark" title="CSS简单技巧">CSS简单技巧</a></li><li><a href="/posts/13596/" rel="bookmark" title="CSS3新特性">CSS3新特性</a></li><li><a href="/posts/63325/" rel="bookmark" title="CSS常用布局">CSS常用布局</a></li><li><a href="/posts/15489/" rel="bookmark" title="响应式布局基础">响应式布局基础</a></li><li><a href="/posts/28818/" rel="bookmark" title="JavaScript语言基础">JavaScript语言基础</a></li><li><a href="/posts/fba5/" rel="bookmark" title="JavaScript原始类型与引用类型">JavaScript原始类型与引用类型</a></li><li><a href="/posts/3b64/" rel="bookmark" title="JavaScript对象、原型与类">JavaScript对象、原型与类</a></li><li><a href="/posts/390000/" rel="bookmark" title="JavaScript函数深入">JavaScript函数深入</a></li><li><a href="/posts/c9b1/" rel="bookmark" title="浏览器环境，Document">浏览器环境，Document</a></li><li class="active"><a href="/posts/c8f1/" rel="bookmark" title="事件初步">事件初步</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Umi" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Umi</p><div class="description" itemprop="description">乌弥的个人博客</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">22</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">14</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VtaXRzdXJ1bWk=" title="https:&#x2F;&#x2F;github.com&#x2F;umitsurumi"><i class="ic i-github"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnlvdXJuYW1lQG1haWwuY29t" title="mailto:yourname@mail.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);" rel="external nofollow noreferrer"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);" rel="external nofollow noreferrer"><i class="ic i-magic"></i>链接</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a href="/favorites/" rel="section"><i class="ic i-star"></i>收藏</a></li></ul></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/posts/c9b1/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/posts/cb89/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Umi @ Umi's Blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">154k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:20</span></div><div class="icp"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://icp.gov.moe/?keyword=20221331">萌ICP备20221331</a></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"posts/c8f1/",favicon:{show:"（●´3｀●）复活成功",hide:"(´Д｀)浏览器崩溃啦"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!1,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true, theme: 'forest' });</script></body></html><!-- rebuild by hrmmi -->